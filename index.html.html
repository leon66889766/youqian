<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>捷配邮签生成器 - 多版式整合</title>
    <style>
        /* 导航栏样式 */
        .nav-container {
            background-color: #00989c;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .nav-btn {
            padding: 10px 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }
        .nav-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        .nav-btn.active {
            background: white;
            color: #00989c;
            font-weight: bold;
        }
        
        /* 版式容器样式 */
        .layout-container {
            display: none;
        }
        .layout-container.active {
            display: block;
        }
        
        /* 版式一的样式 */
        .layout1 .header-banner {
            text-align: center;
            padding: 20px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #eee;
        }
        .layout1 .header-banner h1 {
            margin: 0;
            color: #333;
        }
        .layout1 .language-switch {
            text-align: center;
            margin: 15px 0;
        }
        .layout1 .switch-btn {
            padding: 8px 16px;
            margin: 0 5px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .layout1 .switch-btn:hover {
            background: #45a049;
        }
        .layout1 .switch-btn.active {
            background: #3d8b40;
            font-weight: bold;
        }
        .layout1 .version-container {
            display: none;
        }
        .layout1 .version-container.active {
            display: block;
        }
        .layout1 .upload-section, .layout1 .info-section {max-width:800px;margin:20px auto;padding:20px;border:1px solid #eee;border-radius:8px;}
        .layout1 .upload-item, .layout1 .info-item {margin-bottom:15px;padding:10px;border:1px dashed #ccc;border-radius:4px;}
        .layout1 .upload-item label, .layout1 .info-item label {display:block;font-weight:bold;margin-bottom:5px;}
        .layout1 .upload-item input, .layout1 .info-item input {width:100%;padding:8px;box-sizing:border-box;}
        .layout1 .preview {max-width:200px;margin-top:10px;display:none;}
        .layout1 .signature-preview {max-width:680px;margin:30px auto;border:1px solid #f5f5f5;box-shadow:0 2px 5px rgba(0,0,0,0.1);}
        .layout1 .email-container {width:100%;background:#fff;}
        .layout1 .header {display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:#fff;border-bottom:1px solid #f5f5f5;}
        .layout1 .header-left-logo {width:60px;height:auto;}
        .layout1 .header-right-jiepei {width:220px;height:auto;opacity:0.4;}
        .layout1 .content-area {padding:30px 40px;background:#fff;min-height:380px;}
        .layout1 .signature {padding:0 20px 20px;position:relative;}
        .layout1 .signature-top {display:flex;align-items:center;margin-bottom:10px;}
        .layout1 .signature-left-logo {width:100px;height:auto;margin-right:20px;}
        .layout1 .signature-avatar-wrap {width:80px;height:80px;border-radius:50%;overflow:hidden;margin-right:20px;}
        .layout1 .signature-avatar {width:100%;height:100%;object-fit:cover;}
        .layout1 .signature-info h2 {margin:0;font-size:16px;color:#333;}
        .layout1 .signature-info p {margin:4px 0;font-size:13px;color:#666;}
        .layout1 .signature-right-bg-logo {position:absolute;top:20px;right:20px;width:180px;height:auto;opacity:0.3;z-index:0;}
        .layout1 .signature-banner {width:100%;max-width:640px;height:auto;border-radius:4px;margin-top:10px;z-index:1;position:relative;}
        .layout1 .code-area {display:flex;align-items:center;gap:10px;}
        .layout1 #copyBtnZh, .layout1 #copyBtnEn {padding:8px 16px;background:#4CAF50;color:#fff;border:none;border-radius:4px;cursor:pointer;}
        .layout1 #copyBtnZh:hover, .layout1 #copyBtnEn:hover {background:#45a049;}
        
        /* 版式二的样式 */
        .layout2 * {box-sizing: border-box;}
        .layout2 body {margin: 0; padding: 0; font-family: "Microsoft YaHei", Arial, sans-serif; background: #f5f5f5;}
        .layout2 .container {max-width: 800px; margin: 0 auto; padding: 20px;}
        
        /* 顶部banner样式 */
        .layout2 .top-banner {
            background: #00989c;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }
        .layout2 .top-banner h1 {
            margin: 0 0 10px 0;
            font-size: 22px;
        }
        .layout2 .language-switch {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .layout2 .switch-btn {
            padding: 6px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            background: rgba(255,255,255,0.2);
            color: white;
        }
        .layout2 .switch-btn.active {
            background: white;
            color: #00989c;
            font-weight: bold;
        }

        .layout2 .section {margin: 20px 0; padding: 20px; border: 1px solid #eee; border-radius: 8px; background: #fff;}
        .layout2 .item {margin: 15px 0; padding: 10px; border: 1px dashed #ccc; border-radius: 4px;}
        .layout2 .item label {display: block; font-weight: bold; margin-bottom: 5px; font-size: 14px;}
        .layout2 .item input {width: 100%; padding: 8px; box-sizing: border-box; border: 1px solid #ddd; border-radius: 4px;}
        .layout2 .preview {max-width: 120px; margin-top: 10px; display: none;}
        .layout2 .signature-preview {max-width: 680px; margin: 30px auto; border: 1px solid #e0e0e0; box-shadow: 0 2px 8px rgba(0,0,0,0.08); background: #fff;}
        
        /* 邮签主体（基础样式） */
        .layout2 .email-container {width: 100%; background: #fff;}
        .layout2 .header {display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; background: #fff; border-bottom: 1px solid #f0f0f0;}
        .layout2 .header-left-logo {width: 48px; height: auto;}
        .layout2 .content-area {padding: 22px 28px; background: #fff; min-height: 340px; font-size: 15px; line-height: 1.8; color: #333;}
        .layout2 .signature {padding: 0 20px 12px;}
        .layout2 .signature-banner {width: 100%; height: auto; border-radius: 0; margin-top: 0;}
        
        /* 代码区 */
        .layout2 .code-area {display: flex; align-items: center; gap: 10px; padding: 20px; background: #f8f8f8; border-top: 1px solid #eee;}
        .layout2 #finalCode {width: 100%; height: 180px; padding: 12px; box-sizing: border-box; font-family: monospace; font-size: 12px; border: 1px solid #ddd; border-radius: 4px; resize: none;}
        .layout2 #copyBtn {padding: 8px 16px; background: #4CAF50; color: #fff; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;}
        .layout2 #copyBtn:hover {background: #45a049;}

        /* 中文版式样式 */
        .layout2 .cn-layout .header-right-jiepei {width: 190px; height: auto; opacity: 0.38;}
        .layout2 .cn-layout .signature-info {display: flex; align-items: flex-start; justify-content: space-between; padding: 12px 0; font-size: 12px;}
        .layout2 .cn-layout .info-left {display: flex; align-items: flex-start; padding-left: 0; /* 与上方logo左对齐 */}
        .layout2 .cn-layout .info-text h2 {margin: 0; font-size: 14px; font-weight: 600; color: #222;}
        .layout2 .cn-layout .info-text p {margin: 1px 0; font-size: 11px; color: #666;}
        .layout2 .cn-layout .icon-group {display: flex; gap: 7px; margin-top: 7px;}
        .layout2 .cn-layout .icon-wrap {width: 18px; height: 18px; border-radius: 50%; background: #00989c; display: flex; align-items: center; justify-content: center; overflow: hidden;}
        .layout2 .cn-layout .icon-wrap img {width: 70%; height: auto;}
        .layout2 .cn-layout .info-right {text-align: left; line-height: 1.6;}
        .layout2 .cn-layout .info-right p {margin: 0; font-size: 11px; color: #666;}

        /* 英文版式样式 */
        .layout2 .en-layout .header-right-jiepei {width: 220px; height: auto; opacity: 0.38;}
        .layout2 .en-layout .signature {padding: 0;}
        .layout2 .en-layout .signature-info {
            display: flex; 
            justify-content: space-between; 
            align-items: flex-start; 
            padding: 15px 20px; 
            font-size: 12px;
            gap: 60px;
        }
        .layout2 .en-layout .info-left {
            display: flex; 
            flex-direction: column;
            min-width: 220px;
        }
        .layout2 .en-layout .info-text h2 {
            margin: 0; 
            font-size: 22px; 
            font-weight: 700; 
            color: #222; 
            text-transform: uppercase;
            white-space: nowrap;
        }
        .layout2 .en-layout .info-text p {
            margin: 5px 0 8px; 
            font-size: 12px; 
            color: #666;
        }
        .layout2 .en-layout .icon-group {
            display: flex; 
            gap: 8px;
        }
        .layout2 .en-layout .icon-wrap {
            width: 18px; 
            height: 18px; 
            border-radius: 4px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            overflow: hidden; 
            background: #fff; 
            border: 1px solid #e0e0e0;
        }
        .layout2 .en-layout .icon-wrap img {
            width: 70%; 
            height: auto;
        }
        .layout2 .en-layout .info-right {
            text-align: left; 
            line-height: 1.5; 
            font-size: 12px; 
            color: #666;
            max-width: 300px;
        }
        .layout2 .en-layout .info-right p {
            margin: 0;
        }

        /* 版式切换相关 */
        .layout2 .layout-section {display: none;}
        .layout2 .layout-section.active {display: block;}
        
        /* 版式三的样式 */
        .layout3 * {box-sizing: border-box; margin: 0; padding: 0;}
        .layout3 body {font-family: "Microsoft YaHei", Arial, sans-serif; background: #f5f5f5; padding: 20px;}
        .layout3 .container {max-width: 800px; margin: 0 auto;}
        
        /* 顶部标题区 */
        .layout3 .title-bar {text-align: center; margin-bottom: 20px;}
        .layout3 .title-bar h1 {font-size: 22px; color: #333;}
        
        /* 信息修改区 */
        .layout3 .edit-section {background: #fff; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);}
        .layout3 .edit-section h2 {font-size: 18px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 8px;}
        .layout3 .form-item {margin-bottom: 15px;}
        .layout3 .form-item label {display: block; font-weight: 600; font-size: 14px; color: #666; margin-bottom: 5px;}
        .layout3 .form-item input {width: 100%; padding: 8px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;}
        .layout3 .form-item input[type="file"] {border: 1px dashed #ddd; padding: 8px;}
        .layout3 .preview-img {max-width: 80px; margin-top: 8px; display: none;}
        
        /* 邮签预览区 */
        .layout3 .preview-section {background: #fff; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);}
        .layout3 .preview-section h2 {font-size: 18px; margin-bottom: 15px; text-align: center;}
        .layout3 .signature-preview {max-width: 680px; margin: 0 auto; background: #fff; border: 1px solid #eee; padding: 20px;}
        
        /* 邮签主体样式 */
        .layout3 .email-header {padding: 0 20px; margin-bottom: 20px;}
        .layout3 .header-logo {width: 40px; height: auto;}
        
        /* 正文区域 */
        .layout3 .email-content {padding: 0 20px; min-height: 300px; font-size: 15px; line-height: 1.8; color: #333;}
        
        /* 签名区域 - 核心优化 */
        .layout3 .email-signature {margin-top: 40px; padding-top: 15px;}
        .layout3 .signature-line {width: 100%; height: auto; margin-bottom: 15px;}
        .layout3 .signature-info {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            padding: 0 15px;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        /* 左侧信息区 - 关键修复 */
        .layout3 .info-left {
            display: flex;
            align-items: center;
            gap: 30px;
            flex: 1;
            min-width: 0;
        }
        
        /* 姓名职位容器 - 固定宽度 */
        .layout3 .info-name-title {
            width: 120px;
            flex-shrink: 0;
        }
        .layout3 .info-name-title h3 {font-size: 16px; font-weight: 700; color: #000; margin: 0; line-height: 1.4;}
        .layout3 .info-name-title p {font-size: 12px; color: #666; margin: 4px 0 0; line-height: 1.4;}
        
        /* 联系方式容器 */
        .layout3 .info-details {
            flex: 1;
            min-width: 0;
        }
        .layout3 .info-details p {
            font-size: 12px; 
            color: #666; 
            margin: 4px 0; 
            line-height: 1.6;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .layout3 .info-label {display: inline-block; width: 18px; color: #00989c; font-weight: 600;}
        
        /* 右侧二维码区 */
        .layout3 .info-right {
            text-align: center;
            flex-shrink: 0;
            width: 70px;
            margin-left: auto;
        }
        .layout3 .qrcode-img {width: 60px; height: auto; margin-bottom: 5px;}
        .layout3 .qrcode-text {font-size: 10px; color: #666; white-space: nowrap;}
        
        /* 代码区 */
        .layout3 .code-section {background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);}
        .layout3 .code-area {margin-bottom: 10px;}
        .layout3 .code-area textarea {width: 100%; height: 180px; padding: 12px; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; font-size: 12px; resize: none;}
        .layout3 .copy-btn {padding: 8px 16px; background: #00989c; color: #fff; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;}
        .layout3 .copy-btn:hover {background: #00878a;}

        /* 响应式适配 */
        @media (max-width: 768px) {
            .layout3 .signature-info {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
                padding: 0 10px;
            }
            .layout3 .info-left {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
                width: 100%;
            }
            .layout3 .info-name-title {
                width: 100%;
                margin-bottom: 5px;
            }
            .layout3 .info-details p {
                white-space: normal;
                overflow: visible;
                text-overflow: clip;
            }
            .layout3 .info-right {
                margin-left: 0;
                align-self: center;
                width: 80px;
            }
            .layout3 .qrcode-img {width: 70px;}
            .layout3 .email-header, .layout3 .email-content {padding: 0 10px;}
        }
        
        /* 平板适配 */
        @media (min-width: 576px) and (max-width: 768px) {
            .layout3 .info-left {
                flex-direction: row;
                gap: 20px;
            }
            .layout3 .info-name-title {width: 100px;}
            .layout3 .info-details p {white-space: nowrap;}
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <div class="nav-container">
        <div class="nav-buttons">
            <button class="nav-btn active" data-layout="layout1">版式一</button>
            <button class="nav-btn" data-layout="layout2">版式二</button>
            <button class="nav-btn" data-layout="layout3">版式三</button>
        </div>
    </div>

    <!-- 版式一内容 -->
    <div id="layout1" class="layout-container active layout1">
        <div class="header-banner">
            <h1>版式一</h1>
        </div>
        
        <div class="language-switch">
            <button class="switch-btn active" data-version="zh">中文版</button>
            <button class="switch-btn" data-version="en">English</button>
        </div>

        <!-- 中文版内容 -->
        <div id="zh-version" class="version-container active">
            <!-- 个人信息修改区 -->
            <div class="info-section">
                <h2>步骤1：修改个人信息</h2>
                <div class="info-item">
                    <label>姓名</label>
                    <input type="text" id="zh-name" value="范冰晨">
                </div>
                <div class="info-item">
                    <label>职位</label>
                    <input type="text" id="zh-job" value="品牌平面设计师">
                </div>
                <div class="info-item">
                    <label>电话</label>
                    <input type="text" id="zh-phone" value="+86138-0000-0000">
                </div>
                <div class="info-item">
                    <label>邮箱</label>
                    <input type="text" id="zh-email" value="zhangsan@company.com">
                </div>
                <div class="info-item">
                    <label>地址</label>
                    <input type="text" id="zh-address" value="浙江省杭州市拱墅区新天地商务中心2幢西楼201室">
                </div>
            </div>

            <!-- 图片上传区 -->
            <div class="upload-section">
                <h2>步骤2：上传/使用默认元素</h2>
                <div class="upload-item">
                    <label>1. 上方左侧Logo（默认：https://www.img520.com/JEczek.png）</label>
                    <input type="file" id="zh-logo1" accept="image/png,image/jpg">
                    <img id="zh-preview1" class="preview" alt="上方左侧Logo预览">
                </div>
                <div class="upload-item">
                    <label>2. 上方右侧带透明度JIEPEI（默认：https://www.img520.com/bCH2bq.png）</label>
                    <input type="file" id="zh-logo2" accept="image/png,image/jpg">
                    <img id="zh-preview2" class="preview" alt="上方右侧JIEPEI预览">
                </div>
                <div class="upload-item">
                    <label>3. 下方左侧Logo（默认：https://www.img520.com/PpeGI7.png）</label>
                    <input type="file" id="zh-logo3" accept="image/png,image/jpg">
                    <img id="zh-preview3" class="preview" alt="下方左侧Logo预览">
                </div>
                <div class="upload-item">
                    <label>4. 下方右侧带透明度捷配（默认：https://www.img520.com/wKgZOx.png）</label>
                    <input type="file" id="zh-logo4" accept="image/png,image/jpg">
                    <img id="zh-preview4" class="preview" alt="下方右侧透明捷配预览">
                </div>
                <div class="upload-item">
                    <label>5. 底部Banner（默认：https://www.img520.com/t6R2SL.png）</label>
                    <input type="file" id="zh-banner" accept="image/png,image/jpg">
                    <img id="zh-previewBanner" class="preview" alt="底部Banner预览">
                </div>
            </div>

            <!-- 邮签预览+代码区 -->
            <div class="signature-preview">
                <h2 style="text-align:center;margin:10px 0;">步骤3：邮签预览</h2>
                <div class="email-container">
                    <div class="header">
                        <img id="zh-headerLogo1" src="https://www.img520.com/JEczek.png" alt="上方左侧Logo" class="header-left-logo">
                        <img id="zh-headerLogo2" src="https://www.img520.com/bCH2bq.png" alt="上方右侧JIEPEI" class="header-right-jiepei">
                    </div>
                    <div class="content-area" style="color:#999;">此处填写邮件正文</div>
                    <div class="signature">
                        <img id="zh-signatureLogo4" src="https://www.img520.com/wKgZOx.png" alt="下方右侧透明捷配" class="signature-right-bg-logo">
                        <div class="signature-top">
                            <img id="zh-signatureLogo3" src="https://www.img520.com/PpeGI7.png" alt="下方左侧Logo" class="signature-left-logo">
                            <div class="signature-info" id="zh-previewInfo">
                                <h2>范冰晨</h2>
                                <p>品牌平面设计师</p>
                                <p>电话: +86138-0000-0000</p>
                                <p>邮箱: zhangsan@company.com</p>
                                <p>地址: 浙江省杭州市拱墅区新天地商务中心2幢西楼201室</p>
                            </div>
                        </div>
                        <img id="zh-signatureBanner" src="https://www.img520.com/t6R2SL.png" alt="底部Banner" class="signature-banner">
                    </div>
                </div>

                <div style="padding:20px;">
                    <h3>步骤4：复制邮签代码</h3>
                    <div class="code-area">
                        <textarea id="zh-finalCode" style="width:100%;height:200px;padding:10px;box-sizing:border-box;font-family:monospace;" readonly></textarea>
                        <button id="copyBtnZh">一键复制</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 英文版内容 -->
        <div id="en-version" class="version-container">
            <!-- 个人信息修改区 -->
            <div class="info-section">
                <h2>Step 1: Modify Personal Information</h2>
                <div class="info-item">
                    <label>Name (English)</label>
                    <input type="text" id="en-name" value="FAN BING CHENG">
                </div>
                <div class="info-item">
                    <label>Position (English)</label>
                    <input type="text" id="en-job" value="Brand Graphic Designer">
                </div>
                <div class="info-item">
                    <label>Website</label>
                    <input type="text" id="en-website" value="www.jiepei.com">
                </div>
                <div class="info-item">
                    <label>Phone</label>
                    <input type="text" id="en-phone" value="+86138-0000-0000">
                </div>
                <div class="info-item">
                    <label>Email</label>
                    <input type="text" id="en-email" value="zhangsan@company.com">
                </div>
                <div class="info-item">
                    <label>Address (English)</label>
                    <input type="text" id="en-address" value="Room 1201,West Building of Block 2,Xintiandi Business Center,Gongshu District,Hangzhou City">
                </div>
            </div>

            <!-- 图片上传区 -->
            <div class="upload-section">
                <h2>Step 2: Upload/Use Default Elements</h2>
                <div class="upload-item">
                    <label>1. Top Left Logo (Default: https://www.img520.com/JEczek.png)</label>
                    <input type="file" id="en-logo1" accept="image/png,image/jpg">
                    <img id="en-preview1" class="preview" alt="Top Left Logo Preview">
                </div>
                <div class="upload-item">
                    <label>2. Top Right JIEPEI with Transparency (Default: https://www.img520.com/bCH2bq.png)</label>
                    <input type="file" id="en-logo2" accept="image/png,image/jpg">
                    <img id="en-preview2" class="preview" alt="Top Right JIEPEI Preview">
                </div>
                <div class="upload-item">
                    <label>3. Bottom Avatar (Default: https://www.img520.com/6I8yI8.png, automatically cropped to circle)</label>
                    <input type="file" id="en-avatar" accept="image/png,image/jpg">
                    <img id="en-previewAvatar" class="preview" alt="Avatar Preview">
                </div>
                <div class="upload-item">
                    <label>4. Bottom Banner (Default: https://www.img520.com/Unm8mk.png)</label>
                    <input type="file" id="en-banner" accept="image/png,image/jpg">
                    <img id="en-previewBanner" class="preview" alt="Bottom Banner Preview">
                </div>
            </div>

            <!-- 邮签预览+代码区 -->
            <div class="signature-preview">
                <h2 style="text-align:center;margin:10px 0;">Step 3: Signature Preview</h2>
                <div class="email-container">
                    <div class="header">
                        <img id="en-headerLogo1" src="https://www.img520.com/JEczek.png" alt="Top Left Logo" class="header-left-logo">
                        <img id="en-headerLogo2" src="https://www.img520.com/bCH2bq.png" alt="Top Right JIEPEI" class="header-right-jiepei">
                    </div>
                    <div class="content-area" style="color:#999;">Email content here</div>
                    <div class="signature">
                        <div class="signature-top">
                            <div class="signature-avatar-wrap">
                                <img id="en-signatureAvatar" src="https://www.img520.com/6I8yI8.png" alt="Avatar" class="signature-avatar">
                            </div>
                            <div class="signature-info" id="en-previewInfo">
                                <h2>FAN BING CHENG</h2>
                                <p>Brand Graphic Designer</p>
                                <p>www.jiepei.com</p>
                                <p>+86138-0000-0000</p>
                                <p>zhangsan@company.com</p>
                                <p>Room 1201,West Building of Block 2,Xintiandi Business Center,Gongshu District,Hangzhou City</p>
                            </div>
                        </div>
                        <img id="en-signatureBanner" src="https://www.img520.com/Unm8mk.png" alt="Bottom Banner" class="signature-banner">
                    </div>
                </div>

                <div style="padding:20px;">
                    <h3>Step 4: Copy Signature Code</h3>
                    <div class="code-area">
                        <textarea id="en-finalCode" style="width:100%;height:200px;padding:10px;box-sizing:border-box;font-family:monospace;" readonly></textarea>
                        <button id="copyBtnEn">Copy Code</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 版式二内容 -->
    <div id="layout2" class="layout-container layout2">
        <div class="container">
            <!-- 顶部Banner和切换按钮 -->
            <div class="top-banner">
                <h1 id="layoutTitle">版式一</h1>
                <div class="language-switch">
                    <button class="switch-btn active" data-layout="cn">中文</button>
                    <button class="switch-btn" data-layout="en">English</button>
                </div>
            </div>

            <!-- 中文版式内容 -->
            <div class="layout-section active" id="cnLayout">
                <!-- 个人信息修改区 -->
                <div class="section">
                    <h2 style="font-size:18px; margin-top:0;">步骤1：修改个人信息</h2>
                    <div class="item">
                        <label>姓名</label>
                        <input type="text" id="cnName" value="雷勇杰">
                    </div>
                    <div class="item">
                        <label>职位</label>
                        <input type="text" id="cnJob" value="品牌平面设计师">
                    </div>
                    <div class="item">
                        <label>官网地址</label>
                        <input type="text" id="cnWebsite" value="www.jiepei.com">
                    </div>
                    <div class="item">
                        <label>电话</label>
                        <input type="text" id="cnPhone" value="+86138-0000-0000">
                    </div>
                    <div class="item">
                        <label>邮箱</label>
                        <input type="text" id="cnEmail" value="zhangsan@company.com">
                    </div>
                    <div class="item">
                        <label>地址</label>
                        <input type="text" id="cnAddress" value="杭州市拱墅区新天地商务中心2幢西楼1201室">
                    </div>
                </div>

                <!-- Icon及链接修改区 -->
                <div class="section">
                    <h2 style="font-size:18px; margin-top:0;">步骤2：修改Icon及链接</h2>
                    <div class="item">
                        <label>Icon1（默认：https://www.img520.com/2TM0p0.png）</label>
                        <input type="file" id="cnIcon1" accept="image/png,image/jpg">
                        <img id="cnPreviewIcon1" class="preview" alt="Icon1预览">
                        <label>Icon1跳转链接</label>
                        <input type="text" id="cnLink1" value="https://mp.weixin.qq.com/s/9gYSHCZV2d2Xx169p5d-xw?from=industrynews&color_scheme=light">
                    </div>
                    <div class="item">
                        <label>Icon2（默认：https://www.img520.com/DkwS5F.png）</label>
                        <input type="file" id="cnIcon2" accept="image/png,image/jpg">
                        <img id="cnPreviewIcon2" class="preview" alt="Icon2预览">
                        <label>Icon2跳转链接</label>
                        <input type="text" id="cnLink2" value="https://www.douyin.com/user/MS4wLjABAAAAsaszCTP5scCfE4F-109Tzt6rBM5CjMAMcbBTyIgtLgc_szeEHX5py1QNXgNsxL_n?from_tab_name=main">
                    </div>
                    <div class="item">
                        <label>Icon3（默认：https://www.img520.com/VbLJlt.png）</label>
                        <input type="file" id="cnIcon3" accept="image/png,image/jpg">
                        <img id="cnPreviewIcon3" class="preview" alt="Icon3预览">
                        <label>Icon3跳转链接</label>
                        <input type="text" id="cnLink3" value="https://weibo.com/u/6613361548">
                    </div>
                    <div class="item">
                        <label>Icon4（默认：https://www.img520.com/zUCwCb.png）</label>
                        <input type="file" id="cnIcon4" accept="image/png,image/jpg">
                        <img id="cnPreviewIcon4" class="preview" alt="Icon4预览">
                        <label>Icon4跳转链接</label>
                        <input type="text" id="cnLink4" value="https://www.zhihu.com/org/jie-pei-pcbda-yang">
                    </div>
                </div>

                <!-- 图片上传区 -->
                <div class="section">
                    <h2 style="font-size:18px; margin-top:0;">步骤3：上传/使用默认元素</h2>
                    <div class="item">
                        <label>1. 上方左侧Logo（默认：https://www.img520.com/JEczek.png）</label>
                        <input type="file" id="cnLogo1" accept="image/png,image/jpg">
                        <img id="cnPreviewLogo1" class="preview" alt="上方左侧Logo预览">
                    </div>
                    <div class="item">
                        <label>2. 上方右侧带透明度JIEPEI（默认：https://www.img520.com/bCH2bq.png）</label>
                        <input type="file" id="cnLogo2" accept="image/png,image/jpg">
                        <img id="cnPreviewLogo2" class="preview" alt="上方右侧JIEPEI预览">
                    </div>
                    <div class="item">
                        <label>3. 底部Banner（默认：https://www.img520.com/1WCqY1.png）</label>
                        <input type="file" id="cnBanner" accept="image/png,image/jpg">
                        <img id="cnPreviewBanner" class="preview" alt="底部Banner预览">
                    </div>
                </div>

                <!-- 邮签预览+代码区 -->
                <div class="signature-preview cn-layout">
                    <h2 style="text-align:center; margin:15px 0; font-size:18px; color:#333;">步骤4：邮签预览</h2>
                    <div class="email-container">
                        <div class="header">
                            <img id="cnHeaderLogo1" src="https://www.img520.com/JEczek.png" alt="上方左侧Logo" class="header-left-logo">
                            <img id="cnHeaderLogo2" src="https://www.img520.com/bCH2bq.png" alt="上方右侧JIEPEI" class="header-right-jiepei">
                        </div>
                        <div class="content-area" style="color:#333;">此处填写邮件正文</div>
                        <div class="signature">
                            <img id="cnSignatureBanner" src="https://www.img520.com/1WCqY1.png" alt="底部Banner" class="signature-banner">
                            <div class="signature-info" id="cnPreviewInfo">
                                <div class="info-left">
                                    <div class="info-text">
                                        <h2>雷勇杰</h2>
                                        <p>品牌平面设计师</p>
                                        <div class="icon-group">
                                            <a href="https://mp.weixin.qq.com/s/9gYSHCZV2d2Xx169p5d-xw?from=industrynews&color_scheme=light" target="_blank" class="icon-wrap">
                                                <img id="cnIcon1Preview" src="https://www.img520.com/2TM0p0.png" alt="Icon1">
                                            </a>
                                            <a href="https://www.douyin.com/user/MS4wLjABAAAAsaszCTP5scCfE4F-109Tzt6rBM5CjMAMcbBTyIgtLgc_szeEHX5py1QNXgNsxL_n?from_tab_name=main" target="_blank" class="icon-wrap">
                                                <img id="cnIcon2Preview" src="https://www.img520.com/DkwS5F.png" alt="Icon2">
                                            </a>
                                            <a href="https://weibo.com/u/6613361548" target="_blank" class="icon-wrap">
                                                <img id="cnIcon3Preview" src="https://www.img520.com/VbLJlt.png" alt="Icon3">
                                            </a>
                                            <a href="https://www.zhihu.com/org/jie-pei-pcbda-yang" target="_blank" class="icon-wrap">
                                                <img id="cnIcon4Preview" src="https://www.img520.com/zUCwCb.png" alt="Icon4">
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-right">
                                    <p>www.jiepei.com</p>
                                    <p>+86138-0000-0000</p>
                                    <p>zhangsan@company.com</p>
                                    <p>杭州市拱墅区新天地商务中心2幢西楼1201室</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="code-area">
                        <textarea id="cnFinalCode" readonly></textarea>
                        <button class="copyBtn">一键复制</button>
                    </div>
                </div>
            </div>

            <!-- 英文版式内容 -->
            <div class="layout-section" id="enLayout">
                <!-- 个人信息修改区 -->
                <div class="section">
                    <h2 style="font-size:18px; margin-top:0;">Step 1: Modify Personal Info</h2>
                    <div class="item">
                        <label>Name (UPPERCASE, no line break)</label>
                        <input type="text" id="enName" value="LEI YONG JIE">
                    </div>
                    <div class="item">
                        <label>Position</label>
                        <input type="text" id="enJob" value="Brand Graphic Designer">
                    </div>
                    <div class="item">
                        <label>Website</label>
                        <input type="text" id="enWebsite" value="www.jiepei.com">
                    </div>
                    <div class="item">
                        <label>Phone</label>
                        <input type="text" id="enPhone" value="+86138-0000-0000">
                    </div>
                    <div class="item">
                        <label>Email</label>
                        <input type="text" id="enEmail" value="zhangsan@company.com">
                    </div>
                    <div class="item">
                        <label>Address (will wrap as per preview)</label>
                        <input type="text" id="enAddress" value="Room 1201,West Building of Block 2,Xintiandi Business Center,Gongshu District,Hangzhou City">
                    </div>
                </div>

                <!-- Icon及链接修改区 -->
                <div class="section">
                    <h2 style="font-size:18px; margin-top:0;">Step 2: Modify Icons & Links</h2>
                    <div class="item">
                        <label>Icon 1 (Default: https://www.img520.com/ocOrq8.png)</label>
                        <input type="file" id="enIcon1" accept="image/png,image/jpg">
                        <img id="enPreviewIcon1" class="preview" alt="Icon 1 Preview">
                        <label>Icon 1 Link</label>
                        <input type="text" id="enLink1" value="https://x.com/jiepeigroup">
                    </div>
                    <div class="item">
                        <label>Icon 2 (Default: https://www.img520.com/SSOxP9.png)</label>
                        <input type="file" id="enIcon2" accept="image/png,image/jpg">
                        <img id="enPreviewIcon2" class="preview" alt="Icon 2 Preview">
                        <label>Icon 2 Link</label>
                        <input type="text" id="enLink2" value="https://www.linkedin.com/company/108123638/admin/dashboard/">
                    </div>
                </div>

                <!-- 图片上传区 -->
                <div class="section">
                    <h2 style="font-size:18px; margin-top:0;">Step 3: Upload/Use Default Elements</h2>
                    <div class="item">
                        <label>1. Top Left Logo (Default: https://www.img520.com/JEczek.png)</label>
                        <input type="file" id="enLogo1" accept="image/png,image/jpg">
                        <img id="enPreviewLogo1" class="preview" alt="Top Left Logo Preview">
                    </div>
                    <div class="item">
                        <label>2. Top Right Transparent JIEPEI (Default: https://www.img520.com/1x0ogl.png)</label>
                        <input type="file" id="enLogo2" accept="image/png,image/jpg">
                        <img id="enPreviewLogo2" class="preview" alt="Top Right JIEPEI Preview">
                    </div>
                    <div class="item">
                        <label>3. Bottom Banner (Default: https://www.img520.com/CImOBR.png)</label>
                        <input type="file" id="enBanner" accept="image/png,image/jpg">
                        <img id="enPreviewBanner" class="preview" alt="Bottom Banner Preview">
                    </div>
                </div>

                <!-- 邮签预览+代码区 -->
                <div class="signature-preview en-layout">
                    <h2 style="text-align:center; margin:15px 0; font-size:18px; color:#333;">Step 4: Signature Preview</h2>
                    <div class="email-container">
                        <div class="header">
                            <img id="enHeaderLogo1" src="https://www.img520.com/JEczek.png" alt="Top Left Logo" class="header-left-logo">
                            <img id="enHeaderLogo2" src="https://www.img520.com/1x0ogl.png" alt="Top Right JIEPEI" class="header-right-jiepei">
                        </div>
                        <div class="content-area" style="color:#333;">Email content here</div>
                        <div class="signature">
                            <img id="enSignatureBanner" src="https://www.img520.com/CImOBR.png" alt="Bottom Banner" class="signature-banner">
                            <div class="signature-info" id="enPreviewInfo">
                                <div class="info-left">
                                    <div class="info-text">
                                        <h2>LEI YONG JIE</h2>
                                        <p>Brand Graphic Designer</p>
                                        <div class="icon-group">
                                            <a href="https://x.com/jiepeigroup" target="_blank" class="icon-wrap">
                                                <img id="enIcon1Preview" src="https://www.img520.com/ocOrq8.png" alt="Icon 1">
                                            </a>
                                            <a href="https://www.linkedin.com/company/108123638/admin/dashboard/" target="_blank" class="icon-wrap">
                                                <img id="enIcon2Preview" src="https://www.img520.com/SSOxP9.png" alt="Icon 2">
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-right">
                                    <p>www.jiepei.com</p>
                                    <p>+86138-0000-0000</p>
                                    <p>zhangsan@company.com</p>
                                    <p>Room 1201,West Building of Block 2,Xintiandi</p>
                                    <p>Business Center,Gongshu District,Hangzhou City</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="code-area">
                        <textarea id="enFinalCode" readonly></textarea>
                        <button class="copyBtn">Copy Code</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 版式三内容 -->
    <div id="layout3" class="layout-container layout3">
        <div class="container">
            <!-- 标题区 -->
            <div class="title-bar">
                <h1>捷配电子邮签生成器</h1>
            </div>

            <!-- 信息修改区 -->
            <div class="edit-section">
                <h2>步骤1：修改个人信息</h2>
                <div class="form-item">
                    <label>姓名</label>
                    <input type="text" id="name" value="雷勇杰">
                </div>
                <div class="form-item">
                    <label>职位</label>
                    <input type="text" id="job" value="品牌平面设计师">
                </div>
                <div class="form-item">
                    <label>官网地址</label>
                    <input type="text" id="website" value="www.jiepei.com">
                </div>
                <div class="form-item">
                    <label>电话</label>
                    <input type="text" id="phone" value="+86138-0000-0000">
                </div>
                <div class="form-item">
                    <label>邮箱</label>
                    <input type="text" id="email" value="zhangsan@company.com">
                </div>
                <div class="form-item">
                    <label>地址</label>
                    <input type="text" id="address" value="杭州市拱墅区新天地商务中心2幢西楼1201室">
                </div>
            </div>

            <!-- 图片上传区 -->
            <div class="edit-section">
                <h2>步骤2：上传/使用默认元素</h2>
                <div class="form-item">
                    <label>1. 上方左侧Logo（默认：https://www.img520.com/JEczek.png）</label>
                    <input type="file" id="logo-upload" accept="image/png,image/jpg">
                    <img id="logo-preview" class="preview-img" alt="上方左侧Logo预览">
                </div>
                <div class="form-item">
                    <label>2. 下方横杠图片（默认：https://www.img520.com/GzxDBn.png）</label>
                    <input type="file" id="line-upload" accept="image/png,image/jpg">
                    <img id="line-preview" class="preview-img" alt="下方横杠预览">
                </div>
                <div class="form-item">
                    <label>3. 下方右侧公众号二维码（默认：https://www.img520.com/ONLFVu.png）</label>
                    <input type="file" id="qrcode-upload" accept="image/png,image/jpg">
                    <img id="qrcode-preview" class="preview-img" alt="公众号二维码预览">
                </div>
            </div>

            <!-- 邮签预览区 -->
            <div class="preview-section">
                <h2>步骤3：邮签预览</h2>
                <div class="signature-preview">
                    <!-- 上方左侧Logo -->
                    <div class="email-header">
                        <img id="show-logo" src="https://www.img520.com/JEczek.png" class="header-logo" alt="上方左侧Logo">
                    </div>
                    
                    <!-- 正文区域 -->
                    <div class="email-content">
                        此处填写邮件正文
                    </div>
                    
                    <!-- 签名区域 -->
                    <div class="email-signature">
                        <!-- 下方横杠图片 -->
                        <img id="show-line" src="https://www.img520.com/GzxDBn.png" class="signature-line" alt="下方横杠">
                        
                        <div class="signature-info">
                            <!-- 左侧信息区 -->
                            <div class="info-left">
                                <div class="info-name-title">
                                    <h3 id="show-name">雷勇杰</h3>
                                    <p id="show-job">品牌平面设计师</p>
                                </div>
                                <div class="info-details">
                                    <p>
                                        <span class="info-label">W</span> 
                                        <span id="show-website">www.jiepei.com</span>
                                    </p>
                                    <p>
                                        <span class="info-label">P</span> 
                                        <span id="show-phone">+86138-0000-0000</span>
                                    </p>
                                    <p>
                                        <span class="info-label">E</span> 
                                        <span id="show-email">zhangsan@company.com</span>
                                    </p>
                                    <p>
                                        <span class="info-label">L</span> 
                                        <span id="show-address">杭州市拱墅区新天地商务中心2幢西楼1201室</span>
                                    </p>
                                </div>
                            </div>
                            
                            <!-- 右侧二维码区 -->
                            <div class="info-right">
                                <img id="show-qrcode" src="https://www.img520.com/ONLFVu.png" class="qrcode-img" alt="公众号二维码">
                                <p class="qrcode-text">免费打样上捷配</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 代码生成区 -->
            <div class="code-section">
                <h2>步骤4：生成邮签代码</h2>
                <div class="code-area">
                    <textarea id="signature-code" readonly></textarea>
                </div>
                <button class="copy-btn" id="copy-code">一键复制代码</button>
            </div>
        </div>
    </div>

    <script>
        // 导航栏切换功能
        document.addEventListener('DOMContentLoaded', function() {
            const navBtns = document.querySelectorAll('.nav-btn');
            const layoutContainers = document.querySelectorAll('.layout-container');
            
            navBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const layout = this.getAttribute('data-layout');
                    
                    // 更新按钮状态
                    navBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 显示对应版式内容
                    layoutContainers.forEach(container => {
                        container.classList.remove('active');
                    });
                    document.getElementById(layout).classList.add('active');
                });
            });
            
            // 初始化所有版式的功能
            initLayout1();
            initLayout2();
            initLayout3();
        });
        
        // 版式一功能
        function initLayout1() {
            // 语言切换功能
            const switchBtns = document.querySelectorAll('.layout1 .switch-btn');
            const versionContainers = document.querySelectorAll('.layout1 .version-container');
            
            switchBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const version = this.getAttribute('data-version');
                    
                    // 更新按钮状态
                    switchBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 显示对应版本内容
                    versionContainers.forEach(container => {
                        container.classList.remove('active');
                    });
                    document.getElementById(`${version}-version`).classList.add('active');
                });
            });

            // 中文版功能实现
            (function() {
                // 默认数据 - 已更新底部Banner地址
                const defaults = {
                    logo1: "https://www.img520.com/JEczek.png",
                    logo2: "https://www.img520.com/bCH2bq.png",
                    logo3: "https://www.img520.com/PpeGI7.png",
                    logo4: "https://www.img520.com/wKgZOx.png",
                    banner: "https://www.img520.com/t6R2SL.png",
                    name: "范冰晨",
                    job: "品牌平面设计师",
                    phone: "+86138-0000-0000",
                    email: "zhangsan@company.com",
                    address: "浙江省杭州市拱墅区新天地商务中心2幢西楼201室"
                };
                const data = {...defaults};

                // 监听信息修改
                const infoInputs = ['name', 'job', 'phone', 'email', 'address'];
                infoInputs.forEach(key => {
                    document.getElementById(`zh-${key}`).addEventListener('input', function() {
                        data[key] = this.value;
                        updatePreview();
                        generateCode();
                    });
                });

                // 监听图片上传
                const uploadElements = [
                    {inputId:'logo1',previewId:'preview1',targetId:'headerLogo1'},
                    {inputId:'logo2',previewId:'preview2',targetId:'headerLogo2'},
                    {inputId:'logo3',previewId:'preview3',targetId:'signatureLogo3'},
                    {inputId:'logo4',previewId:'preview4',targetId:'signatureLogo4'},
                    {inputId:'banner',previewId:'previewBanner',targetId:'signatureBanner'}
                ];
                uploadElements.forEach(item => {
                    document.getElementById(`zh-${item.inputId}`).addEventListener('change', function(e) {
                        const file = e.target.files[0];
                        if(file){
                            const reader = new FileReader();
                            reader.onload = function(event) {
                                document.getElementById(`zh-${item.previewId}`).src = event.target.result;
                                document.getElementById(`zh-${item.previewId}`).style.display = 'block';
                                document.getElementById(`zh-${item.targetId}`).src = event.target.result;
                                data[item.inputId] = event.target.result;
                                generateCode();
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                });

                // 更新预览信息
                function updatePreview() {
                    const infoEl = document.getElementById('zh-previewInfo');
                    infoEl.innerHTML = `
                        <h2>${data.name}</h2>
                        <p>${data.job}</p>
                        <p>电话: ${data.phone}</p>
                        <p>邮箱: ${data.email}</p>
                        <p>地址: ${data.address}</p>
                    `;
                }

                // 生成代码
                function generateCode() {
                    const code = `
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>捷配电子邮签</title>
    <style>
        body{margin:0;padding:0;font-family:"Microsoft YaHei",Arial,sans-serif;background:#fff;}
        .email-container{width:100%;max-width:680px;margin:0 auto;background:#fff;}
        .header{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:#fff;border-bottom:1px solid #f5f5f5;}
        .header-left-logo{width:60px;height:auto;}
        .header-right-jiepei{width:220px;height:auto;opacity:0.4;}
        .content-area{padding:30px 40px;background:#fff;min-height:380px;}
        .signature{padding:0 20px 20px;position:relative;}
        .signature-top{display:flex;align-items:center;margin-bottom:10px;}
        .signature-left-logo{width:100px;height:auto;margin-right:20px;}
        .signature-info h2{margin:0;font-size:16px;color:#333;}
        .signature-info p{margin:4px 0;font-size:13px;color:#666;}
        .signature-right-bg-logo{position:absolute;top:20px;right:20px;width:180px;height:auto;opacity:0.3;z-index:0;}
        .signature-banner{width:100%;max-width:640px;height:auto;border-radius:4px;margin-top:10px;z-index:1;position:relative;}
    </style>
</head>
<body>
    <div class="email-container">
        <div class="header">
            <img src="${data.logo1}" alt="上方左侧Logo" class="header-left-logo">
            <img src="${data.logo2}" alt="上方右侧JIEPEI" class="header-right-jiepei">
        </div>
        <div class="content-area">
            <!-- 填写邮件正文 -->
        </div>
        <div class="signature">
            <img src="${data.logo4}" alt="下方右侧透明捷配" class="signature-right-bg-logo">
            <div class="signature-top">
                <img src="${data.logo3}" alt="下方左侧Logo" class="signature-left-logo">
                <div class="signature-info">
                    <h2>${data.name}</h2>
                    <p>${data.job}</p>
                    <p>电话: ${data.phone}</p>
                    <p>邮箱: ${data.email}</p>
                    <p>地址: ${data.address}</p>
                </div>
            </div>
            <img src="${data.banner}" alt="底部Banner" class="signature-banner">
        </div>
    </div>
</body>
</html>
                    `.trim();
                    document.getElementById('zh-finalCode').value = code;
                }

                // 一键复制
                document.getElementById('copyBtnZh').addEventListener('click', function() {
                    const codeText = document.getElementById('zh-finalCode');
                    codeText.select();
                    document.execCommand('copy');
                    this.textContent = '已复制!';
                    setTimeout(() => this.textContent = '一键复制', 2000);
                });

                // 初始化
                updatePreview();
                generateCode();
            })();

            // 英文版功能实现
            (function() {
                // 默认数据 - 已更新底部Banner地址
                const defaults = {
                    logo1: "https://www.img520.com/JEczek.png",
                    logo2: "https://www.img520.com/bCH2bq.png",
                    avatar: "https://www.img520.com/6I8yI8.png",
                    banner: "https://www.img520.com/Unm8mk.png",
                    name: "FAN BING CHENG",
                    job: "Brand Graphic Designer",
                    website: "www.jiepei.com",
                    phone: "+86138-0000-0000",
                    email: "zhangsan@company.com",
                    address: "Room 1201,West Building of Block 2,Xintiandi Business Center,Gongshu District,Hangzhou City"
                };
                const data = {...defaults};

                // 监听信息修改
                const infoInputs = ['name', 'job', 'website', 'phone', 'email', 'address'];
                infoInputs.forEach(key => {
                    document.getElementById(`en-${key}`).addEventListener('input', function() {
                        data[key] = this.value;
                        updatePreview();
                        generateCode();
                    });
                });

                // 监听图片上传
                const uploadElements = [
                    {inputId:'logo1',previewId:'preview1',targetId:'headerLogo1'},
                    {inputId:'logo2',previewId:'preview2',targetId:'headerLogo2'},
                    {inputId:'avatar',previewId:'previewAvatar',targetId:'signatureAvatar'},
                    {inputId:'banner',previewId:'previewBanner',targetId:'signatureBanner'}
                ];
                uploadElements.forEach(item => {
                    document.getElementById(`en-${item.inputId}`).addEventListener('change', function(e) {
                        const file = e.target.files[0];
                        if(file){
                            const reader = new FileReader();
                            reader.onload = function(event) {
                                document.getElementById(`en-${item.previewId}`).src = event.target.result;
                                document.getElementById(`en-${item.previewId}`).style.display = 'block';
                                document.getElementById(`en-${item.targetId}`).src = event.target.result;
                                data[item.inputId] = event.target.result;
                                generateCode();
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                });

                // 更新预览信息
                function updatePreview() {
                    const infoEl = document.getElementById('en-previewInfo');
                    infoEl.innerHTML = `
                        <h2>${data.name}</h2>
                        <p>${data.job}</p>
                        <p>${data.website}</p>
                        <p>${data.phone}</p>
                        <p>${data.email}</p>
                        <p>${data.address}</p>
                    `;
                }

                // 生成代码
                function generateCode() {
                    const code = `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Jiepei Email Signature</title>
    <style>
        body{margin:0;padding:0;font-family:Arial,sans-serif;background:#fff;}
        .email-container{width:100%;max-width:680px;margin:0 auto;background:#fff;}
        .header{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:#fff;border-bottom:1px solid #f5f5f5;}
        .header-left-logo{width:60px;height:auto;}
        .header-right-jiepei{width:220px;height:auto;opacity:0.4;}
        .content-area{padding:30px 40px;background:#fff;min-height:380px;}
        .signature{padding:0 20px 20px;}
        .signature-top{display:flex;align-items:center;margin-bottom:10px;}
        .signature-avatar-wrap{width:80px;height:80px;border-radius:50%;overflow:hidden;margin-right:20px;}
        .signature-avatar{width:100%;height:100%;object-fit:cover;}
        .signature-info h2{margin:0;font-size:16px;color:#333;}
        .signature-info p{margin:4px 0;font-size:13px;color:#666;}
        .signature-banner{width:100%;max-width:640px;height:auto;border-radius:4px;margin-top:10px;}
    </style>
</head>
<body>
    <div class="email-container">
        <div class="header">
            <img src="${data.logo1}" alt="Top Left Logo" class="header-left-logo">
            <img src="${data.logo2}" alt="Top Right JIEPEI" class="header-right-jiepei">
        </div>
        <div class="content-area">
            <!-- Email Content Here -->
        </div>
        <div class="signature">
            <div class="signature-top">
                <div class="signature-avatar-wrap">
                    <img src="${data.avatar}" alt="Avatar" class="signature-avatar">
                </div>
                <div class="signature-info">
                    <h2>${data.name}</h2>
                    <p>${data.job}</p>
                    <p>${data.website}</p>
                    <p>${data.phone}</p>
                    <p>${data.email}</p>
                    <p>${data.address}</p>
                </div>
            </div>
            <img src="${data.banner}" alt="Bottom Banner" class="signature-banner">
        </div>
    </div>
</body>
</html>
                    `.trim();
                    document.getElementById('en-finalCode').value = code;
                }

                // 一键复制
                document.getElementById('copyBtnEn').addEventListener('click', function() {
                    const codeText = document.getElementById('en-finalCode');
                    codeText.select();
                    document.execCommand('copy');
                    this.textContent = 'Copied!';
                    setTimeout(() => this.textContent = 'Copy Code', 2000);
                });

                // 初始化
                updatePreview();
                generateCode();
            })();
        }
        
        // 版式二功能
        function initLayout2() {
            // 中英文版式数据存储
            const layouts = {
                cn: {
                    defaults: {
                        logo1: "https://www.img520.com/JEczek.png",
                        logo2: "https://www.img520.com/bCH2bq.png",
                        banner: "https://www.img520.com/1WCqY1.png",
                        icon1: "https://www.img520.com/2TM0p0.png",
                        icon2: "https://www.img520.com/DkwS5F.png",
                        icon3: "https://www.img520.com/VbLJlt.png",
                        icon4: "https://www.img520.com/zUCwCb.png",
                        link1: "https://mp.weixin.qq.com/s/9gYSHCZV2d2Xx169p5d-xw?from=industrynews&color_scheme=light",
                        link2: "https://www.douyin.com/user/MS4wLjABAAAAsaszCTP5scCfE4F-109Tzt6rBM5CjMAMcbBTyIgtLgc_szeEHX5py1QNXgNsxL_n?from_tab_name=main",
                        link3: "https://weibo.com/u/6613361548",
                        link4: "https://www.zhihu.com/org/jie-pei-pcbda-yang",
                        name: "雷勇杰",
                        job: "品牌平面设计师",
                        website: "www.jiepei.com",
                        phone: "+86138-0000-0000",
                        email: "zhangsan@company.com",
                        address: "杭州市拱墅区新天地商务中心2幢西楼1201室"
                    },
                    data: {},
                    iconKeys: ['icon1', 'icon2', 'icon3', 'icon4'],
                    imgKeys: ['logo1', 'logo2', 'banner'],
                    infoKeys: ['name', 'job', 'website', 'phone', 'email', 'address']
                },
                en: {
                    defaults: {
                        logo1: "https://www.img520.com/JEczek.png",
                        logo2: "https://www.img520.com/1x0ogl.png",
                        banner: "https://www.img520.com/CImOBR.png",
                        icon1: "https://www.img520.com/ocOrq8.png",
                        icon2: "https://www.img520.com/SSOxP9.png",
                        link1: "https://x.com/jiepeigroup",
                        link2: "https://www.linkedin.com/company/108123638/admin/dashboard/",
                        name: "LEI YONG JIE",
                        job: "Brand Graphic Designer",
                        website: "www.jiepei.com",
                        phone: "+86138-0000-0000",
                        email: "zhangsan@company.com",
                        address: "Room 1201,West Building of Block 2,Xintiandi Business Center,Gongshu District,Hangzhou City"
                    },
                    data: {},
                    iconKeys: ['icon1', 'icon2'],  // 修改为2个icon
                    imgKeys: ['logo1', 'logo2', 'banner'],
                    infoKeys: ['name', 'job', 'website', 'phone', 'email', 'address']
                }
            };

            // 初始化数据
            for (const layout in layouts) {
                layouts[layout].data = {...layouts[layout].defaults};
            }

            // 初始化中文版式
            function initCNLayout() {
                const layout = layouts.cn;
                
                // 监听信息修改
                layout.infoKeys.forEach(key => {
                    document.getElementById(`cn${key.charAt(0).toUpperCase() + key.slice(1)}`).addEventListener('input', function() {
                        layout.data[key] = this.value;
                        updateCNPreview();
                        generateCNCode();
                    });
                });

                // 监听Icon及链接修改
                layout.iconKeys.forEach(key => {
                    // Icon图片
                    document.getElementById(`cn${key.charAt(0).toUpperCase() + key.slice(1)}`).addEventListener('change', function(e) {
                        const file = e.target.files[0];
                        if(file){
                            const reader = new FileReader();
                            reader.onload = function(event) {
                                layout.data[key] = event.target.result;
                                document.getElementById(`cn${key}Preview`).src = event.target.result;
                                document.getElementById(`cnPreview${key.charAt(0).toUpperCase() + key.slice(1)}`).src = event.target.result;
                                document.getElementById(`cnPreview${key.charAt(0).toUpperCase() + key.slice(1)}`).style.display = 'block';
                                generateCNCode();
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                    // Icon链接
                    document.getElementById(`cnLink${key.slice(4)}`).addEventListener('input', function() {
                        layout.data[`link${key.slice(4)}`] = this.value;
                        updateCNPreview();
                        generateCNCode();
                    });
                });

                // 监听图片上传
                layout.imgKeys.forEach(key => {
                    document.getElementById(`cn${key.charAt(0).toUpperCase() + key.slice(1)}`).addEventListener('change', function(e) {
                        const file = e.target.files[0];
                        if(file){
                            const reader = new FileReader();
                            reader.onload = function(event) {
                                layout.data[key] = event.target.result;
                                const targetId = key === 'logo1' ? 'cnHeaderLogo1' : key === 'logo2' ? 'cnHeaderLogo2' : 'cnSignatureBanner';
                                document.getElementById(targetId).src = event.target.result;
                                document.getElementById(`cnPreview${key.charAt(0).toUpperCase() + key.slice(1)}`).src = event.target.result;
                                document.getElementById(`cnPreview${key.charAt(0).toUpperCase() + key.slice(1)}`).style.display = 'block';
                                generateCNCode();
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                });

                // 初始化
                updateCNPreview();
                generateCNCode();
            }

            // 更新中文预览
            function updateCNPreview() {
                const data = layouts.cn.data;
                const infoEl = document.getElementById('cnPreviewInfo');
                infoEl.innerHTML = `
                    <div class="info-left">
                        <div class="info-text">
                            <h2>${data.name}</h2>
                            <p>${data.job}</p>
                            <div class="icon-group">
                                <a href="${data.link1}" target="_blank" class="icon-wrap">
                                    <img id="cnIcon1Preview" src="${data.icon1}" alt="Icon1">
                                </a>
                                <a href="${data.link2}" target="_blank" class="icon-wrap">
                                    <img id="cnIcon2Preview" src="${data.icon2}" alt="Icon2">
                                </a>
                                <a href="${data.link3}" target="_blank" class="icon-wrap">
                                    <img id="cnIcon3Preview" src="${data.icon3}" alt="Icon3">
                                </a>
                                <a href="${data.link4}" target="_blank" class="icon-wrap">
                                    <img id="cnIcon4Preview" src="${data.icon4}" alt="Icon4">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="info-right">
                        <p>${data.website}</p>
                        <p>${data.phone}</p>
                        <p>${data.email}</p>
                        <p>${data.address}</p>
                    </div>
                `;
            }

            // 生成中文代码
            function generateCNCode() {
                const data = layouts.cn.data;
                const code = `
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>捷配电子邮签</title>
    <style>
        body{margin:0; padding:0; font-family:"Microsoft YaHei",Arial,sans-serif; background:#fff;}
        .email-container{width:100%; max-width:680px; margin:0 auto; background:#fff;}
        .header{display:flex; justify-content:space-between; align-items:center; padding:10px 20px; background:#fff; border-bottom:1px solid #f0f0f0;}
        .header-left-logo{width:48px; height:auto;}
        .header-right-jiepei{width:190px; height:auto; opacity:0.38;}
        .content-area{padding:22px 28px; background:#fff; min-height:340px; font-size:15px; line-height:1.8; color:#333;}
        .signature{padding:0 20px 12px;}
        .signature-banner{width:100%; height:auto; border-radius:0; margin-top:0;}
        .signature-info{display:flex; align-items:flex-start; justify-content:space-between; padding:12px 0; font-size:12px;}
        .info-left{display:flex; align-items:flex-start; padding-left:0;}
        .info-text h2{margin:0; font-size:14px; font-weight:600; color:#222;}
        .info-text p{margin:1px 0; font-size:11px; color:#666;}
        .icon-group{display:flex; gap:7px; margin-top:7px;}
        .icon-wrap{width:18px; height:18px; border-radius:50%; background:#00989c; display:flex; align-items:center; justify-content:center; overflow:hidden;}
        .icon-wrap img{width:70%; height:auto;}
        .info-right{text-align:left; line-height:1.6;}
        .info-right p{margin:0; font-size:11px; color:#666;}
    </style>
</head>
<body>
    <div class="email-container">
        <div class="header">
            <img src="${data.logo1}" alt="上方左侧Logo" class="header-left-logo">
            <img src="${data.logo2}" alt="上方右侧JIEPEI" class="header-right-jiepei">
        </div>
        <div class="content-area">
            <!-- 填写邮件正文 -->
        </div>
        <div class="signature">
            <img src="${data.banner}" alt="底部Banner" class="signature-banner">
            <div class="signature-info">
                <div class="info-left">
                    <div class="info-text">
                        <h2>${data.name}</h2>
                        <p>${data.job}</p>
                        <div class="icon-group">
                            <a href="${data.link1}" target="_blank" class="icon-wrap">
                                <img src="${data.icon1}" alt="Icon1">
                            </a>
                            <a href="${data.link2}" target="_blank" class="icon-wrap">
                                <img src="${data.icon2}" alt="Icon2">
                            </a>
                            <a href="${data.link3}" target="_blank" class="icon-wrap">
                                <img src="${data.icon3}" alt="Icon3">
                            </a>
                            <a href="${data.link4}" target="_blank" class="icon-wrap">
                                <img src="${data.icon4}" alt="Icon4">
                            </a>
                        </div>
                    </div>
                </div>
                <div class="info-right">
                    <p>${data.website}</p>
                    <p>${data.phone}</p>
                    <p>${data.email}</p>
                    <p>${data.address}</p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
                `.trim();
                document.getElementById('cnFinalCode').value = code;
            }

            // 初始化英文版式
            function initENLayout() {
                const layout = layouts.en;
                
                // 监听信息修改
                layout.infoKeys.forEach(key => {
                    document.getElementById(`en${key.charAt(0).toUpperCase() + key.slice(1)}`).addEventListener('input', function() {
                        layout.data[key] = this.value;
                        updateENPreview();
                        generateENCode();
                    });
                });

                // 处理地址折行
                function formatAddress(address) {
                    const parts = address.split('Xintiandi');
                    if (parts.length > 1) {
                        return `Room 1201,West Building of Block 2,Xintiandi\nBusiness Center,Gongshu District,Hangzhou City`;
                    }
                    return address;
                }

                // 监听Icon及链接修改
                layout.iconKeys.forEach(key => {
                    // Icon图片
                    document.getElementById(`en${key.charAt(0).toUpperCase() + key.slice(1)}`).addEventListener('change', function(e) {
                        const file = e.target.files[0];
                        if(file){
                            const reader = new FileReader();
                            reader.onload = function(event) {
                                layout.data[key] = event.target.result;
                                document.getElementById(`en${key}Preview`).src = event.target.result;
                                document.getElementById(`enPreview${key.charAt(0).toUpperCase() + key.slice(1)}`).src = event.target.result;
                                document.getElementById(`enPreview${key.charAt(0).toUpperCase() + key.slice(1)}`).style.display = 'block';
                                generateENCode();
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                    // Icon链接
                    document.getElementById(`enLink${key.slice(4)}`).addEventListener('input', function() {
                        layout.data[`link${key.slice(4)}`] = this.value;
                        updateENPreview();
                        generateENCode();
                    });
                });

                // 监听图片上传
                layout.imgKeys.forEach(key => {
                    document.getElementById(`en${key.charAt(0).toUpperCase() + key.slice(1)}`).addEventListener('change', function(e) {
                        const file = e.target.files[0];
                        if(file){
                            const reader = new FileReader();
                            reader.onload = function(event) {
                                layout.data[key] = event.target.result;
                                const targetId = key === 'logo1' ? 'enHeaderLogo1' : key === 'logo2' ? 'enHeaderLogo2' : 'enSignatureBanner';
                                document.getElementById(targetId).src = event.target.result;
                                document.getElementById(`enPreview${key.charAt(0).toUpperCase() + key.slice(1)}`).src = event.target.result;
                                document.getElementById(`enPreview${key.charAt(0).toUpperCase() + key.slice(1)}`).style.display = 'block';
                                generateENCode();
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                });

                // 初始化
                updateENPreview();
                generateENCode();
            }

            // 更新英文预览
            function updateENPreview() {
                const data = layouts.en.data;
                const infoEl = document.getElementById('enPreviewInfo');
                
                // 处理地址折行
                const addressParts = data.address.split('Xintiandi');
                let addressHtml = '';
                if (addressParts.length > 1) {
                    addressHtml = `
                        <p>Room 1201,West Building of Block 2,Xintiandi</p>
                        <p>Business Center,Gongshu District,Hangzhou City</p>
                    `;
                } else {
                    addressHtml = `<p>${data.address}</p>`;
                }
                
                infoEl.innerHTML = `
                    <div class="info-left">
                        <div class="info-text">
                            <h2>${data.name}</h2>
                            <p>${data.job}</p>
                            <div class="icon-group">
                                <a href="${data.link1}" target="_blank" class="icon-wrap">
                                    <img id="enIcon1Preview" src="${data.icon1}" alt="Icon 1">
                                </a>
                                <a href="${data.link2}" target="_blank" class="icon-wrap">
                                    <img id="enIcon2Preview" src="${data.icon2}" alt="Icon 2">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="info-right">
                        <p>${data.website}</p>
                        <p>${data.phone}</p>
                        <p>${data.email}</p>
                        ${addressHtml}
                    </div>
                `;
            }

            // 生成英文代码
            function generateENCode() {
                const data = layouts.en.data;
                
                // 处理地址折行
                const addressParts = data.address.split('Xintiandi');
                let addressHtml = '';
                if (addressParts.length > 1) {
                    addressHtml = `
                        <p>Room 1201,West Building of Block 2,Xintiandi</p>
                        <p>Business Center,Gongshu District,Hangzhou City</p>
                    `;
                } else {
                    addressHtml = `<p>${data.address}</p>`;
                }
                
                const code = `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Jiepei Email Signature</title>
    <style>
        body{margin:0; padding:0; font-family:Arial,sans-serif; background:#fff;}
        .email-container{width:100%; max-width:680px; margin:0 auto; background:#fff;}
        .header{display:flex; justify-content:space-between; align-items:center; padding:10px 20px; background:#fff; border-bottom:1px solid #f0f0f0;}
        .header-left-logo{width:48px; height:auto;}
        .header-right-jiepei{width:220px; height:auto; opacity:0.38;}
        .content-area{padding:22px 28px; background:#fff; min-height:340px; font-size:15px; line-height:1.8; color:#333;}
        .signature{padding:0;}
        .signature-banner{width:100%; height:auto; border-radius:0; margin-top:0;}
        .signature-info{display:flex; justify-content:space-between; align-items:flex-start; padding:15px 20px; font-size:12px; gap:60px;}
        .info-left{display:flex; flex-direction:column; min-width:220px;}
        .info-text h2{margin:0; font-size:22px; font-weight:700; color:#222; text-transform:uppercase; white-space:nowrap;}
        .info-text p{margin:5px 0 8px; font-size:12px; color:#666;}
        .icon-group{display:flex; gap:8px;}
        .icon-wrap{width:18px; height:18px; border-radius:4px; display:flex; align-items:center; justify-content:center; overflow:hidden; background:#fff; border:1px solid #e0e0e0;}
        .icon-wrap img{width:70%; height:auto;}
        .info-right{text-align:left; line-height:1.5; font-size:12px; color:#666; max-width:300px;}
        .info-right p{margin:0;}
    </style>
</head>
<body>
    <div class="email-container">
        <div class="header">
            <img src="${data.logo1}" alt="Top Left Logo" class="header-left-logo">
            <img src="${data.logo2}" alt="Top Right JIEPEI" class="header-right-jiepei">
        </div>
        <div class="content-area">
            <!-- Email content here -->
        </div>
        <div class="signature">
            <img src="${data.banner}" alt="Bottom Banner" class="signature-banner">
            <div class="signature-info">
                <div class="info-left">
                    <div class="info-text">
                        <h2>${data.name}</h2>
                        <p>${data.job}</p>
                        <div class="icon-group">
                            <a href="${data.link1}" target="_blank" class="icon-wrap">
                                <img src="${data.icon1}" alt="Icon 1">
                            </a>
                            <a href="${data.link2}" target="_blank" class="icon-wrap">
                                <img src="${data.icon2}" alt="Icon 2">
                            </a>
                        </div>
                    </div>
                </div>
                <div class="info-right">
                    <p>${data.website}</p>
                    <p>${data.phone}</p>
                    <p>${data.email}</p>
                    ${addressHtml}
                </div>
            </div>
        </div>
    </div>
</body>
</html>
                `.trim();
                document.getElementById('enFinalCode').value = code;
            }

            // 初始化语言切换
            function initLanguageSwitch() {
                const switchBtns = document.querySelectorAll('.layout2 .switch-btn');
                const layoutSections = document.querySelectorAll('.layout2 .layout-section');
                
                switchBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        // 更新按钮状态
                        switchBtns.forEach(b => b.classList.remove('active'));
                        this.classList.add('active');
                        
                        // 显示对应版式
                        const layout = this.getAttribute('data-layout');
                        layoutSections.forEach(section => {
                            section.classList.remove('active');
                        });
                        document.getElementById(`${layout}Layout`).classList.add('active');
                    });
                });
            }

            // 初始化复制按钮
            function initCopyButtons() {
                const copyBtns = document.querySelectorAll('.layout2 .copyBtn');
                copyBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        const textarea = this.previousElementSibling;
                        textarea.select();
                        document.execCommand('copy');
                        
                        // 显示复制成功提示
                        const originalText = this.textContent;
                        this.textContent = '已复制!';
                        setTimeout(() => {
                            this.textContent = originalText;
                        }, 2000);
                    });
                });
            }

            // 初始化版式二
            initCNLayout();
            initENLayout();
            initLanguageSwitch();
            initCopyButtons();
        }
        
        // 版式三功能 - 修复版
        function initLayout3() {
            // 默认数据配置
            const defaultData = {
                name: "雷勇杰",
                job: "品牌平面设计师",
                website: "www.jiepei.com",
                phone: "+86138-0000-0000",
                email: "zhangsan@company.com",
                address: "杭州市拱墅区新天地商务中心2幢西楼1201室",
                images: {
                    logo: "https://www.img520.com/JEczek.png",
                    line: "https://www.img520.com/GzxDBn.png",
                    qrcode: "https://www.img520.com/ONLFVu.png"
                }
            };

            let currentData = JSON.parse(JSON.stringify(defaultData));

            // 监听个人信息输入
            ["name", "job", "website", "phone", "email", "address"].forEach(key => {
                const input = document.getElementById(key);
                if (input) {
                    input.addEventListener("input", function() {
                        currentData[key] = this.value;
                        updatePreview();
                        updateCode();
                    });
                }
            });

            // 监听图片上传
            const imageMap = [
                {id: "logo-upload", key: "logo", showId: "show-logo", previewId: "logo-preview"},
                {id: "line-upload", key: "line", showId: "show-line", previewId: "line-preview"},
                {id: "qrcode-upload", key: "qrcode", showId: "show-qrcode", previewId: "qrcode-preview"}
            ];
            
            imageMap.forEach(item => {
                const upload = document.getElementById(item.id);
                if (upload) {
                    upload.addEventListener("change", e => {
                        const file = e.target.files[0];
                        if (file) {
                            const reader = new FileReader();
                            reader.onload = function() {
                                currentData.images[item.key] = reader.result;
                                document.getElementById(item.showId).src = reader.result;
                                const preview = document.getElementById(item.previewId);
                                if (preview) {
                                    preview.src = reader.result;
                                    preview.style.display = "block";
                                }
                                updateCode();
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                }
            });

            // 更新预览区
            function updatePreview() {
                const elements = {
                    "show-name": currentData.name,
                    "show-job": currentData.job,
                    "show-website": currentData.website,
                    "show-phone": currentData.phone,
                    "show-email": currentData.email,
                    "show-address": currentData.address
                };
                
                for (const [id, value] of Object.entries(elements)) {
                    const element = document.getElementById(id);
                    if (element) element.textContent = value;
                }
            }

            // 生成邮签代码
            function updateCode() {
                try {
                    const code = `<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>捷配电子邮签</title>
    <style>
        * {margin: 0; padding: 0; box-sizing: border-box;}
        body {font-family: "Microsoft YaHei", Arial, sans-serif; background: #fff;}
        .email-container {max-width: 680px; margin: 0 auto; padding: 20px;}
        .email-header {padding: 0 20px; margin-bottom: 20px;}
        .header-logo {width: 40px; height: auto;}
        .email-content {padding: 0 20px; min-height: 300px; font-size: 15px; line-height: 1.8; color: #333;}
        .email-signature {margin-top: 40px; padding-top: 15px;}
        .signature-line {width: 100%; height: auto; margin-bottom: 15px;}
        .signature-info {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            padding: 0 15px;
            gap: 15px;
            flex-wrap: wrap;
        }
        .info-left {
            display: flex;
            align-items: center;
            gap: 30px;
            flex: 1;
            min-width: 0;
        }
        .info-name-title {
            width: 120px;
            flex-shrink: 0;
        }
        .info-name-title h3 {font-size: 16px; font-weight: 700; color: #000; margin: 0; line-height: 1.4;}
        .info-name-title p {font-size: 12px; color: #666; margin: 4px 0 0; line-height: 1.4;}
        .info-details {
            flex: 1;
            min-width: 0;
        }
        .info-details p {
            font-size: 12px; 
            color: #666; 
            margin: 4px 0; 
            line-height: 1.6;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .info-label {display: inline-block; width: 18px; color: #00989c; font-weight: 600;}
        .info-right {
            text-align: center;
            flex-shrink: 0;
            width: 70px;
            margin-left: auto;
        }
        .qrcode-img {width: 60px; height: auto; margin-bottom: 5px;}
        .qrcode-text {font-size: 10px; color: #666; white-space: nowrap;}
        @media (max-width: 768px) {
            .signature-info {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
                padding: 0 10px;
            }
            .info-left {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
                width: 100%;
            }
            .info-name-title {
                width: 100%;
                margin-bottom: 5px;
            }
            .info-details p {
                white-space: normal;
                overflow: visible;
                text-overflow: clip;
            }
            .info-right {
                margin-left: 0;
                align-self: center;
                width: 80px;
            }
            .qrcode-img {width: 70px;}
            .email-header, .email-content {padding: 0 10px;}
        }
        @media (min-width: 576px) and (max-width: 768px) {
            .info-left {
                flex-direction: row;
                gap: 20px;
            }
            .info-name-title {width: 100px;}
            .info-details p {white-space: nowrap;}
        }
    </style>
</head>
<body>
    <div class="email-container">
        <div class="email-header">
            <img src="${currentData.images.logo}" class="header-logo" alt="上方左侧Logo">
        </div>
        <div class="email-content">
            <!-- 在此处填写邮件正文 -->
        </div>
        <div class="email-signature">
            <img src="${currentData.images.line}" class="signature-line" alt="下方横杠">
            <div class="signature-info">
                <div class="info-left">
                    <div class="info-name-title">
                        <h3>${currentData.name}</h3>
                        <p>${currentData.job}</p>
                    </div>
                    <div class="info-details">
                        <p><span class="info-label">W</span> ${currentData.website}</p>
                        <p><span class="info-label">P</span> ${currentData.phone}</p>
                        <p><span class="info-label">E</span> ${currentData.email}</p>
                        <p><span class="info-label">L</span> ${currentData.address}</p>
                    </div>
                </div>
                <div class="info-right">
                    <img src="${currentData.images.qrcode}" class="qrcode-img" alt="公众号二维码">
                    <p class="qrcode-text">免费打样上捷配</p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>`;

                    const codeTextarea = document.getElementById("signature-code");
                    if (codeTextarea) {
                        codeTextarea.value = code;
                    }
                } catch (error) {
                    console.error("生成代码时出错：", error);
                }
            }

            // 一键复制代码
            const copyBtn = document.getElementById("copy-code");
            if (copyBtn) {
                copyBtn.addEventListener("click", function() {
                    const codeEl = document.getElementById("signature-code");
                    if (!codeEl || !codeEl.value) {
                        alert("无代码可复制！");
                        return;
                    }

                    try {
                        codeEl.select();
                        if (navigator.clipboard) {
                            navigator.clipboard.writeText(codeEl.value).then(() => {
                                showCopySuccess();
                            }).catch(err => {
                                console.error("剪贴板API失败：", err);
                                fallbackCopy();
                            });
                        } else {
                            fallbackCopy();
                        }
                    } catch (err) {
                        console.error("复制失败：", err);
                        fallbackCopy();
                    }

                    function showCopySuccess() {
                        copyBtn.textContent = "复制成功！";
                        setTimeout(() => copyBtn.textContent = "一键复制代码", 2000);
                    }

                    function fallbackCopy() {
                        try {
                            document.execCommand("copy");
                            showCopySuccess();
                        } catch (err) {
                            alert("复制失败，请手动复制代码！");
                        }
                    }
                });
            }

            // 初始化：生成初始代码
            updatePreview();
            updateCode();
        }
    </script>
</body>
</html>